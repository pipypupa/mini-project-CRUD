async function e(){try{return await fetch("https://6882a21521fa24876a9b6374.mockapi.io/posts").then(e=>e.json())}catch(e){console.log(e)}}async function t(e){try{return await fetch("https://6882a21521fa24876a9b6374.mockapi.io/posts",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json; charset=UTF-8"}}).then(e=>e.json())}catch(e){console.log(e)}}async function o(e,t){try{let o=await fetch(`https://6882a21521fa24876a9b6374.mockapi.io/posts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!o.ok)throw Error("Failed to update post");return await o.json()}catch(e){throw console.error("Failed to update post:",e),e}}async function c(e){try{return await fetch(`https://6882a21521fa24876a9b6374.mockapi.io/posts/${e}`,{method:"DELETE"})}catch(e){console.log(e)}}async function n(e,t){try{return await fetch(`https://6882a21521fa24876a9b6374.mockapi.io/posts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({likes:e})}).then(e=>e.json())}catch(e){console.log(e)}}async function a(e,t,o){try{return await fetch(`https://6882a21521fa24876a9b6374.mockapi.io/posts/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({comments:o,commentList:e})}).then(e=>e.json())}catch(e){console.log(e)}}let s=[],r=null,l=null;async function i(){let t=await e();document.querySelector(".posts").innerHTML=t.map(e=>`
    <li class="post-card" data-id="${e.id}">
    <img class="photo-post" src="${e.imageUrl}" alt="photo" />
        <p class="user">${e.userName}</p>
        <div class="stats">
            <p id="like" class="stats-item">
                <button class="like-button"><i class="material-icons">thumb_up</i></button>
                <span class="likes-p">${e.likes}</span>
            </p>
            <p id="comment" class="stats-item">
                <button class="comment-button"><i class="material-icons">comment</i></button>
                <span class="commments-count">${e.comments}</span>
            </p>
        </div>
        <button type="click" class="edit">Edit</button>
        <button type="click" class="delete">Delete</button>
    </li>
    `).join(""),s=t}i(),document.querySelector(".add").addEventListener("click",()=>{document.querySelector(".modal-backdrop").classList.remove("hidden")}),document.querySelector(".close-modal").addEventListener("click",()=>{document.querySelector(".modal-backdrop").classList.add("hidden")}),document.querySelector("#new-post-form").addEventListener("submit",async e=>{e.preventDefault();let o=e.target.elements.url.value,c=e.target.elements.Username.value;await t({userName:c,imageUrl:o,likes:0,comments:0,commentList:[]}),await i(),document.querySelector(".modal-backdrop").classList.add("hidden"),e.target.reset()}),document.querySelector(".close-comment-button").addEventListener("click",()=>{document.querySelector(".modal-backdropCommments").classList.add("hidden")}),document.querySelector(".close-modalEdit").addEventListener("click",()=>{document.querySelector(".modal-backdropEdit").classList.add("hidden")}),document.querySelector(".posts").addEventListener("click",e=>{let t=e.target.closest(".post-card");if(!t)return;let o=t.dataset.id;if(e.target.closest(".like-button")){let c=e.target.closest(".like-button"),a=t.querySelector(".likes-p"),s=Number(a.textContent);if(c.classList.contains("liked"))return;a.textContent=s+=1,c.classList.add("liked"),n(s,o)}if(e.target.closest(".comment-button")){var a;r=o,document.querySelector(".modal-backdropCommments").classList.remove("hidden");let e=s.find(e=>e.id===r);document.querySelector(".comments").innerHTML=Array.isArray(a=e.commentList)?a.map(e=>`
            <li data-comment="This is a comment to delete" class="comment-card">
                <div class="div-comment"><p class="comment-info">${e}</p></div>
                <button class="delete-comment">Delete</button>
            </li>
        `).join(""):(console.warn("renderComments expected an array, but got:",a),"<li class='comment-card'>No comments yet.</li>")}e.target.closest(".delete")&&c(o).then(()=>i()),e.target.closest(".edit")&&(l=o,document.querySelector("#username").value=t.querySelector(".user").textContent,document.querySelector("#url").value=t.querySelector(".photo-post").src,document.querySelector(".modal-backdropEdit").classList.remove("hidden"))}),document.querySelector(".edit-button").addEventListener("click",async()=>{let e={userName:document.querySelector("#username").value,imageUrl:document.querySelector("#url").value};try{await o(e,l),await i(),document.querySelector(".modal-backdropEdit").classList.add("hidden")}catch(e){console.error("Error updating post:",e)}}),document.querySelector('#search-form input[name="query"]').addEventListener("input",e=>{let t=e.target.value.toLowerCase();document.querySelectorAll(".post-card").forEach(e=>{let o=e.querySelector(".user").textContent.toLowerCase();e.style.display=o.includes(t)?"block":"none"})}),document.querySelector(".post-comment-button").addEventListener("click",async()=>{let e=document.querySelector("#info").value.trim();if(!e)return;let t=[...s.find(e=>e.id===r).commentList,e],o=t.length;await a(t,r,o),await i(),document.querySelector(".modal-backdropCommments").classList.add("hidden"),document.querySelector("#info").value=""}),document.querySelector(".comments").addEventListener("click",e=>{if(e.target.closest(".delete-comment")){let t=e.target.closest("li.comment-card").querySelector(".comment-info").textContent.trim(),o=s.find(e=>e.id===r).commentList.filter(e=>e!==t),c=o.length;a(o,r,c).then(()=>i()),document.querySelector(".modal-backdropCommments").classList.add("hidden")}});
//# sourceMappingURL=mini-project-CRUD.4cb3fffc.js.map
